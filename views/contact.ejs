<%- include ("header.ejs")%>

<section id="title-banner">

    <div class="container">
        <div class="carousel-item active">
            <div class="row">
                <h1 class="mb-3 worked-title">Contact-us</h1>
                <div class="col-12 col-md-12 col-lg-6 title">
                    <h1>Do you have any questions? Please do not hesitate to contact us directly. Our team will come back to you within a matter of hours to help you.</h1>
                    <a class="btn btn-hero btn-outline-dark btn-lg" href="#contact-form">To the Form</a>
                 </div>
                <div class="col-12 col-md-12 col-lg-6 text-center">
                    <img src="/main-ai.svg" class="img-fluid border border-2 border-warning rounded-circle" alt="image-of-ideas-human" width="65%">
                </div>
            </div>
        </div>
    </div>

</section>

<section id="contact-form">
    <div class="container contact-form-box">
        <div class="row">
            <div class="col-12 col-md-12 col-lg-6">
                <h1 class="navbar-brand contact-logo">EDV</h1>
            </div>
            <span id="success" class="fw-bolder text-center text-capitalize p-2" style="color: #0083ff;"></span>
            <div class="col-12 col-md-12 cl-lg-6 contact-form">
                <form id="myForm" class="row g-2" name="submit-to-google-sheet">
                    <div class="col-md-6 w-50">
                        <label for="firstName" class="form-label">First Name</label>
                        <input type="text" name="firstName" class="form-control" id="firstName" required>
                    </div>
                    <div class="col-md-6 w-50">
                        <label for="lastName" class="form-label">Last Name</label>
                        <input type="text" name="lastName" class="form-control" id="lastName" required>
                    </div>
                    <div class="col-md-12">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" name="email" class="form-control" id="email" required>
                    </div>
                    <div class="col-md-12">
                        <label for="contactNumber" class="form-label">Contact No.</label>
                        <input type="tel" name="contactNumber" class="form-control" id="contactNum" required>
                    </div>
                    <div class="col-md-12">
                        <label for="exampleFormControlTextarea1" class="form-label">Message</label>
                        <textarea class="form-control" name="message" id="exampleFormControlTextarea1" rows="3"></textarea required>
                    </div>
                    <div class="col-12 text-center">
                        <button type="submit" class="btn btn-outline-dark btn-lg fw-bolder">Sign Up!</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<script>
    
// form script
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzTh-m3i2J2ryEdyvooIlIX0DQnYDAyzpsBTboqRjMCUp6jWO9QMyx8nqenMMguiRiZ/exec'
  const form = document.forms['submit-to-google-sheet']
  const success = document.getElementById("success") 
  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => {
        success.innerHTML = "Thanks for providing your query!";
        setTimeout(()=>{
          success.innerHTML = "";
        }, 5000)
        form.reset();
      })
      .catch(error => console.error('Error!', error.message))
  });
</script>

<%- include ("footer.ejs")%>